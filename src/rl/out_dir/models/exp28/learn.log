  File "rddpg.py", line 222
    return states, actor_recurrent_states, actions \
            params, rewards, next_states, \
        ^
SyntaxError: invalid syntax
2021-04-17 15:17:00.280083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
Unable to init server: Could not connect: Connection refused
Unable to init server: Could not connect: Connection refused

(learn.py:2206485): Gdk-CRITICAL **: 15:17:20.554: gdk_cursor_new_for_display: assertion 'GDK_IS_DISPLAY (display)' failed
2021-04-17 15:17:21.954503: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 15:17:21.960993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-17 15:17:22.026966: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:22.031808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:1e.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-17 15:17:22.031854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-17 15:17:22.061372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-17 15:17:22.063212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-17 15:17:22.073359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 15:17:22.077255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 15:17:22.105652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 15:17:22.110209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-17 15:17:22.113666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-17 15:17:22.113975: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:22.120488: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:22.124512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
[DDPG] Building the actor model
2021-04-17 15:17:22.213047: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-17 15:17:22.213895: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 15:17:22.216541: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:22.221229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:1e.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-17 15:17:22.221414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-17 15:17:22.221739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-17 15:17:22.223321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-17 15:17:22.224948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 15:17:22.225683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 15:17:22.226033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 15:17:22.226313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-17 15:17:22.226624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-17 15:17:22.228109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:22.233864: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:22.237364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 15:17:22.237840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-17 15:17:26.717709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-17 15:17:26.718941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-17 15:17:26.719185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-17 15:17:26.721482: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:26.727031: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:26.733362: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:17:26.737528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13104 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:1e.0, compute capability: 7.5)
[DDPG] Building the actor model
[DDPG] Building the critic model
[DDPG] Building the critic model
[DDPG] Waiting for joint trajectory action
[DDPG] Found joint trajectory action!
[DDPG] Waiting for joint trajectory action
[DDPG] Found joint trajectory action!
[DDPG] Waiting for joint trajectory action
[DDPG] Found joint trajectory action!
[DDPG] Waiting for joint trajectory action
[DDPG] Found joint trajectory action!
[0m[ INFO] [1618672667.862954678, 7.733000000]: Loading robot model 'quadruped'...[0m
[0m[ INFO] [1618672667.864521859, 7.734000000]: No root/virtual joint specified in SRDF. Assuming fixed joint[0m
[33m[ WARN] [1618672667.864717022, 7.734000000]: Link dummy_link has visual geometry but no collision geometry. Collision geometry will be left empty. Fix your URDF file by explicitly specifying collision geometry.[0m
[0m[ INFO] [1618672669.680866601, 8.187000000]: Ready to take commands for planning group front_right_leg.[0m
[0m[ INFO] [1618672671.958796613, 8.800000000]: Ready to take commands for planning group front_left_leg.[0m
[0m[ INFO] [1618672675.043508861, 9.600000000]: Ready to take commands for planning group back_right_leg.[0m
[0m[ INFO] [1618672678.783436383, 10.600000000]: Ready to take commands for planning group back_left_leg.[0m
[Actor] GPU>>>>>>>>>>>>
[Actor] [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
[DDPG] Loading Actor Weights
[DDPG] Initializing HER
[DDPG] Training Start
[DDPG] Resetting Environment
[DDPG] Starting Pretraining Test
2021-04-17 15:19:30.946771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-17 15:19:35.098254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
[DDPG] Step 0 Reward 39.68084 Time 26.85611
[DDPG] Quadruped Not Upright
Traceback (most recent call last):
  File "learn.py", line 1494, in <module>
    learner.learn(
  File "learn.py", line 782, in learn
    self.current_time_step = self.env.step(
  File "/home/ubuntu/CPGController/src/rl/env.py", line 75, in step
    return self._step(action, desired_motion, last_step)
  File "/home/ubuntu/CPGController/src/rl/env.py", line 120, in _step
    if not rddpg:
NameError: name 'rddpg' is not defined
2021-04-17 15:21:24.300618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
Unable to init server: Could not connect: Connection refused
Unable to init server: Could not connect: Connection refused

(learn.py:2208249): Gdk-CRITICAL **: 15:21:39.009: gdk_cursor_new_for_display: assertion 'GDK_IS_DISPLAY (display)' failed
2021-04-17 15:21:40.350743: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 15:21:40.354753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-17 15:21:40.408284: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:40.409572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:1e.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-17 15:21:40.409616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-17 15:21:40.428635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-17 15:21:40.430196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-17 15:21:40.438388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 15:21:40.440005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 15:21:40.459257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 15:21:40.463890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-17 15:21:40.465055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-17 15:21:40.465856: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:40.470042: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:40.473088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
[DDPG] Building the actor model
2021-04-17 15:21:40.533898: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-17 15:21:40.534475: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 15:21:40.536187: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:40.540152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:1e.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s
2021-04-17 15:21:40.540191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-17 15:21:40.540354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-17 15:21:40.540466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-17 15:21:40.541610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 15:21:40.542758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 15:21:40.542918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 15:21:40.543063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-17 15:21:40.543811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-17 15:21:40.544797: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:40.547520: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:40.551229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 15:21:40.551506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-17 15:21:42.981522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-17 15:21:42.981764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-17 15:21:42.981794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-17 15:21:42.982325: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:42.983531: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:42.984702: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 15:21:42.986152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13104 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:1e.0, compute capability: 7.5)
[DDPG] Building the actor model
[DDPG] Building the critic model
[DDPG] Building the critic model
[DDPG] Waiting for joint trajectory action
[DDPG] Found joint trajectory action!
[DDPG] Waiting for joint trajectory action
[DDPG] Found joint trajectory action!
[DDPG] Waiting for joint trajectory action
[DDPG] Found joint trajectory action!
[DDPG] Waiting for joint trajectory action
[DDPG] Found joint trajectory action!
[0m[ INFO] [1618672922.667676327, 5.422000000]: Loading robot model 'quadruped'...[0m
[0m[ INFO] [1618672922.670838503, 5.422000000]: No root/virtual joint specified in SRDF. Assuming fixed joint[0m
[33m[ WARN] [1618672922.670938860, 5.422000000]: Link dummy_link has visual geometry but no collision geometry. Collision geometry will be left empty. Fix your URDF file by explicitly specifying collision geometry.[0m
[0m[ INFO] [1618672924.286208760, 5.860000000]: Ready to take commands for planning group front_right_leg.[0m
[0m[ INFO] [1618672926.892771948, 6.593000000]: Ready to take commands for planning group front_left_leg.[0m
[0m[ INFO] [1618672929.599340116, 7.393000000]: Ready to take commands for planning group back_right_leg.[0m
[0m[ INFO] [1618672932.458256184, 8.193000000]: Ready to take commands for planning group back_left_leg.[0m
[Actor] GPU>>>>>>>>>>>>
[Actor] [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
[DDPG] Loading Actor Weights
[DDPG] Initializing HER
[DDPG] Training Start
[DDPG] Resetting Environment
[DDPG] Starting Pretraining Test
2021-04-17 15:23:42.384510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-17 15:23:46.057132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
[DDPG] Step 0 Reward 68.98952 Time 26.88405
[DDPG] Step 1 Reward -3.00224 Time 20.80188
[DDPG] Step 2 Reward -1.16041 Time 20.90807
[DDPG] Quadruped Not Upright
[DDPG] Step 3 Reward -3.19387 Time 20.67985
[DDPG] Quadruped Not Upright
[DDPG] Step 4 Reward 3.89052 Time 18.61848
[DDPG] Resetting Environment
[DDPG] Starting Episode 0
[DDPG] Quadruped Not Upright
[DDPG] Episode 0 Step 0 Reward -1.29019 Time 20.22608
[DDPG] Starting Next Episode
[DDPG] Critic Loss 20.489953994750977
[DDPG] Total Reward -1.29019 Avg Critic Loss 20.48995 Time 8.16877
[DDPG] Saving Data
[DDPG] Saving HER goals
[DDPG] Saving Model
[DDPG] Resetting Environment
[DDPG] Starting Episode 1
[DDPG] Episode 1 Step 0 Reward -1.31284 Time 26.90708
[DDPG] Episode 1 Step 1 Reward -3.44592 Time 22.80988
[DDPG] Episode 1 Step 2 Reward -2.50648 Time 21.84653
[DDPG] Episode 1 Step 3 Reward 1.89224 Time 22.63240
[DDPG] Episode 1 Step 4 Reward -4.08855 Time 25.82077
[DDPG] Episode 1 Step 5 Reward -0.94523 Time 27.85021
[DDPG] Quadruped Not Upright
[DDPG] Episode 1 Step 6 Reward -6.87866 Time 24.33598
[DDPG] Starting Next Episode
[DDPG] Critic Loss 11.30730152130127
[DDPG] Total Reward -17.28544 Avg Critic Loss 11.30730 Time 8.10172
[DDPG] Resetting Environment
[DDPG] Starting Episode 2
[DDPG] Episode 2 Step 0 Reward 2.01706 Time 27.50710
[DDPG] Quadruped Not Upright
[DDPG] Episode 2 Step 1 Reward -6.02397 Time 23.01041
[DDPG] Starting Next Episode
[DDPG] Critic Loss 15.504707336425781
[DDPG] Total Reward -4.00692 Avg Critic Loss 15.50471 Time 10.43483
[DDPG] Resetting Environment
[DDPG] Starting Episode 3
[DDPG] Episode 3 Step 0 Reward -1.48864 Time 27.14621
[DDPG] Quadruped Not Upright
[DDPG] Episode 3 Step 1 Reward -6.43562 Time 25.19577
[DDPG] Starting Next Episode
[DDPG] Critic Loss 16.36992073059082
[DDPG] Total Reward -7.92426 Avg Critic Loss 16.36992 Time 10.49699
[DDPG] Resetting Environment
[DDPG] Starting Episode 4
[DDPG] Episode 4 Step 0 Reward -2.21910 Time 27.17475
[DDPG] Quadruped Not Upright
[DDPG] Episode 4 Step 1 Reward -0.18957 Time 22.75620
[DDPG] Starting Next Episode
[DDPG] Critic Loss 91.35151672363281
[DDPG] Total Reward -2.40866 Avg Critic Loss 91.35152 Time 11.65175
[DDPG] Resetting Environment
[DDPG] Starting Episode 5
[DDPG] Episode 5 Step 0 Reward -0.94711 Time 26.28275
[DDPG] Floating Point Error in reward computation
[DDPG] Critic Loss 85.17332458496094
[DDPG] Total Reward -0.94711 Avg Critic Loss 85.17332 Time 10.80657
[DDPG] Resetting Environment
[DDPG] Starting Episode 6
[DDPG] Quadruped Not Upright
[DDPG] Episode 6 Step 0 Reward -1.50554 Time 22.94164
[DDPG] Starting Next Episode
[DDPG] Critic Loss 79.50263977050781
[DDPG] Total Reward -1.50554 Avg Critic Loss 79.50264 Time 10.51028
[DDPG] Resetting Environment
[DDPG] Starting Episode 7
[DDPG] Episode 7 Step 0 Reward -2.18624 Time 28.82074
[DDPG] Episode 7 Step 1 Reward -1.59014 Time 29.17846
